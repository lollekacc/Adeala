<!DOCTYPE html>
<html lang="sv">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Adeala – Quiz Mobil</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="assets/style.css">
  <script defer src="assets/quiz.js"></script>
</head>

<body class="font-[Inter] bg-white text-gray-900">
  <div id="header-placeholder"></div>

  <section class="min-h-screen flex flex-col items-center justify-center text-center px-6">
    <h1 class="text-4xl font-bold text-blue-700 mb-8">Hitta rätt mobilabonnemang</h1>

    <form id="quiz-form" class="bg-gray-100 p-8 rounded-2xl shadow max-w-md w-full space-y-6">

      <!-- Question 1 -->
      <div>
        <p class="font-semibold mb-2">Hur mycket surfar du per månad?</p>
        <select id="dataNeed" class="w-full p-3 border rounded">
          <option value="low">Lite (upp till 10 GB)</option>
          <option value="medium">Medel (10–50 GB)</option>
          <option value="high">Mycket (obegränsat)</option>
        </select>
      </div>

      <!-- Question 2 -->
      <div>
        <p class="font-semibold mb-2">Hur mycket vill du betala per månad?</p>
        <select id="maxPrice" class="w-full p-3 border rounded">
          <option value="249">Under 250 kr</option>
          <option value="349">Upp till 350 kr</option>
          <option value="449">Upp till 450 kr</option>
          <option value="999">Spelar ingen roll</option>
        </select>
      </div>

      <!-- Question 3 -->
      <div>
        <p class="font-semibold mb-2">Vilken operatör föredrar du?</p>
        <select id="operator" class="w-full p-3 border rounded">
          <option value="">Ingen speciell</option>
          <option value="Telia">Telia</option>
          <option value="Tele2">Tele2</option>
          <option value="Telenor">Telenor</option>
          <option value="Tre">Tre</option>
          <option value="Halebop">Halebop</option>
        </select>
      </div>

      <!-- ✅ NEW QUESTION -->
      <div id="numberOption">
        <p class="font-semibold mb-3">Vill du flytta hit ditt nummer eller skaffa nytt?</p>
        <div class="flex flex-col gap-3">
          <button type="button" id="moveNumberBtn"
            class="bg-blue-600 text-white py-3 rounded hover:bg-blue-700 transition">
            Flytta hit nummer
          </button>
          <button type="button" id="newNumberBtn"
            class="bg-gray-200 text-gray-800 py-3 rounded hover:bg-gray-300 transition">
            Skaffa nytt nummer
          </button>
        </div>
      </div>

      <!-- Hidden section for entering current number -->
      <div id="numberInputSection" class="hidden">
        <p class="font-semibold mb-2">Ange ditt nuvarande telefonnummer</p>
        <input id="phoneNumber" type="tel" placeholder="0701234567 eller +46701234567"
          class="w-full p-3 border rounded text-center" />
        <p id="numberError" class="text-red-600 text-sm mt-1"></p>
      </div>

      <!-- Submit -->
      <button type="submit" id="submitBtn"
        class="w-full bg-blue-600 text-white py-3 rounded hover:bg-blue-700 transition hidden">
        Visa erbjudanden
      </button>
    </form>
  </section>

  <script>
    const moveBtn = document.getElementById("moveNumberBtn");
    const newBtn = document.getElementById("newNumberBtn");
    const inputSection = document.getElementById("numberInputSection");
    const phoneInput = document.getElementById("phoneNumber");
    const errorMsg = document.getElementById("numberError");
    const submitBtn = document.getElementById("submitBtn");

    // If user selects "Flytta hit nummer"
    moveBtn.addEventListener("click", () => {
      inputSection.classList.remove("hidden");
      submitBtn.classList.remove("hidden");
    });

    // If user selects "Skaffa nytt nummer"
    newBtn.addEventListener("click", () => {
      inputSection.classList.add("hidden");
      errorMsg.textContent = "";
      submitBtn.classList.remove("hidden");
    });

    document.getElementById("quiz-form").addEventListener("submit", (e) => {
      e.preventDefault();

      // Validate phone if visible
      if (!inputSection.classList.contains("hidden")) {
        const num = phoneInput.value.trim();
        const pattern = /^(07\d{8}|\+467\d{8})$/;
        if (!pattern.test(num)) {
          errorMsg.textContent = "Numret måste vara giltigt (börja med 07 eller +46 följt av 9 siffror).";
          return;
        }
      }

      const results = {
        category: "mobil",
        dataNeed: document.getElementById("dataNeed").value,
        maxPrice: Number(document.getElementById("maxPrice").value),
        operators: [document.getElementById("operator").value].filter(Boolean),
        numberAction: inputSection.classList.contains("hidden") ? "new" : "move",
        phoneNumber: phoneInput.value || null
      };

      saveQuizResults(results);
    });
  </script>

</body>
</html>
